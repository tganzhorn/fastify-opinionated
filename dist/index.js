var Ae=Object.create;var se=Object.defineProperty;var Le=Object.getOwnPropertyDescriptor;var Be=Object.getOwnPropertyNames;var Ue=Object.getPrototypeOf,We=Object.prototype.hasOwnProperty;var Ve=(u,a)=>()=>(a||u((a={exports:{}}).exports,a),a.exports);var Xe=(u,a,c,y)=>{if(a&&typeof a=="object"||typeof a=="function")for(let m of Be(a))!We.call(u,m)&&m!==c&&se(u,m,{get:()=>a[m],enumerable:!(y=Le(a,m))||y.enumerable});return u};var Ye=(u,a,c)=>(c=u!=null?Ae(Ue(u)):{},Xe(a||!u||!u.__esModule?se(c,"default",{value:u,enumerable:!0}):c,u));var ce=Ve(()=>{"use strict";var fe;(function(u){(function(a){var c=typeof globalThis=="object"?globalThis:typeof global=="object"?global:typeof self=="object"?self:typeof this=="object"?this:P(),y=m(u);typeof c.Reflect<"u"&&(y=m(c.Reflect,y)),a(y,c),typeof c.Reflect>"u"&&(c.Reflect=u);function m(C,R){return function(k,x){Object.defineProperty(C,k,{configurable:!0,writable:!0,value:x}),R&&R(k,x)}}function T(){try{return Function("return this;")()}catch{}}function g(){try{return(0,eval)("(function() { return this; })()")}catch{}}function P(){return T()||g()}})(function(a,c){var y=Object.prototype.hasOwnProperty,m=typeof Symbol=="function",T=m&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",g=m&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",P=typeof Object.create=="function",C={__proto__:[]}instanceof Array,R=!P&&!C,k={create:P?function(){return U(Object.create(null))}:C?function(){return U({__proto__:null})}:function(){return U({})},has:R?function(e,t){return y.call(e,t)}:function(e,t){return t in e},get:R?function(e,t){return y.call(e,t)?e[t]:void 0}:function(e,t){return e[t]}},x=Object.getPrototypeOf(Function),O=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:Fe(),H=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:Ge(),N=typeof WeakMap=="function"?WeakMap:$e(),D=m?Symbol.for("@reflect-metadata:registry"):void 0,$=Ie(),W=je($);function ye(e,t,r,n){if(l(r)){if(!ee(e))throw new TypeError;if(!te(t))throw new TypeError;return Ce(e,t)}else{if(!ee(e))throw new TypeError;if(!w(t))throw new TypeError;if(!w(n)&&!l(n)&&!I(n))throw new TypeError;return I(n)&&(n=void 0),r=S(r),Re(e,t,r,n)}}a("decorate",ye);function ve(e,t){function r(n,d){if(!w(n))throw new TypeError;if(!l(d)&&!Se(d))throw new TypeError;Q(e,t,n,d)}return r}a("metadata",ve);function me(e,t,r,n){if(!w(r))throw new TypeError;return l(n)||(n=S(n)),Q(e,t,r,n)}a("defineMetadata",me);function we(e,t,r){if(!w(t))throw new TypeError;return l(r)||(r=S(r)),V(e,t,r)}a("hasMetadata",we);function Me(e,t,r){if(!w(t))throw new TypeError;return l(r)||(r=S(r)),A(e,t,r)}a("hasOwnMetadata",Me);function _e(e,t,r){if(!w(t))throw new TypeError;return l(r)||(r=S(r)),X(e,t,r)}a("getMetadata",_e);function ge(e,t,r){if(!w(t))throw new TypeError;return l(r)||(r=S(r)),Y(e,t,r)}a("getOwnMetadata",ge);function be(e,t){if(!w(e))throw new TypeError;return l(t)||(t=S(t)),z(e,t)}a("getMetadataKeys",be);function Pe(e,t){if(!w(e))throw new TypeError;return l(t)||(t=S(t)),J(e,t)}a("getOwnMetadataKeys",Pe);function xe(e,t,r){if(!w(t))throw new TypeError;if(l(r)||(r=S(r)),!w(t))throw new TypeError;l(r)||(r=S(r));var n=F(t,r,!1);return l(n)?!1:n.OrdinaryDeleteMetadata(e,t,r)}a("deleteMetadata",xe);function Ce(e,t){for(var r=e.length-1;r>=0;--r){var n=e[r],d=n(t);if(!l(d)&&!I(d)){if(!te(d))throw new TypeError;t=d}}return t}function Re(e,t,r,n){for(var d=e.length-1;d>=0;--d){var M=e[d],b=M(t,r,n);if(!l(b)&&!I(b)){if(!w(b))throw new TypeError;n=b}}return n}function V(e,t,r){var n=A(e,t,r);if(n)return!0;var d=B(t);return I(d)?!1:V(e,d,r)}function A(e,t,r){var n=F(t,r,!1);return l(n)?!1:K(n.OrdinaryHasOwnMetadata(e,t,r))}function X(e,t,r){var n=A(e,t,r);if(n)return Y(e,t,r);var d=B(t);if(!I(d))return X(e,d,r)}function Y(e,t,r){var n=F(t,r,!1);if(!l(n))return n.OrdinaryGetOwnMetadata(e,t,r)}function Q(e,t,r,n){var d=F(r,n,!0);d.OrdinaryDefineOwnMetadata(e,t,r,n)}function z(e,t){var r=J(e,t),n=B(e);if(n===null)return r;var d=z(n,t);if(d.length<=0)return r;if(r.length<=0)return d;for(var M=new H,b=[],p=0,o=r;p<o.length;p++){var i=o[p],s=M.has(i);s||(M.add(i),b.push(i))}for(var f=0,h=d;f<h.length;f++){var i=h[f],s=M.has(i);s||(M.add(i),b.push(i))}return b}function J(e,t){var r=F(e,t,!1);return r?r.OrdinaryOwnMetadataKeys(e,t):[]}function Z(e){if(e===null)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return e===null?1:6;default:return 6}}function l(e){return e===void 0}function I(e){return e===null}function Oe(e){return typeof e=="symbol"}function w(e){return typeof e=="object"?e!==null:typeof e=="function"}function Te(e,t){switch(Z(e)){case 0:return e;case 1:return e;case 2:return e;case 3:return e;case 4:return e;case 5:return e}var r=t===3?"string":t===5?"number":"default",n=re(e,T);if(n!==void 0){var d=n.call(e,r);if(w(d))throw new TypeError;return d}return ke(e,r==="default"?"number":r)}function ke(e,t){if(t==="string"){var r=e.toString;if(j(r)){var n=r.call(e);if(!w(n))return n}var d=e.valueOf;if(j(d)){var n=d.call(e);if(!w(n))return n}}else{var d=e.valueOf;if(j(d)){var n=d.call(e);if(!w(n))return n}var M=e.toString;if(j(M)){var n=M.call(e);if(!w(n))return n}}throw new TypeError}function K(e){return!!e}function Ee(e){return""+e}function S(e){var t=Te(e,3);return Oe(t)?t:Ee(t)}function ee(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:Object.prototype.toString.call(e)==="[object Array]"}function j(e){return typeof e=="function"}function te(e){return typeof e=="function"}function Se(e){switch(Z(e)){case 3:return!0;case 4:return!0;default:return!1}}function L(e,t){return e===t||e!==e&&t!==t}function re(e,t){var r=e[t];if(r!=null){if(!j(r))throw new TypeError;return r}}function ne(e){var t=re(e,g);if(!j(t))throw new TypeError;var r=t.call(e);if(!w(r))throw new TypeError;return r}function ae(e){return e.value}function oe(e){var t=e.next();return t.done?!1:t}function ie(e){var t=e.return;t&&t.call(e)}function B(e){var t=Object.getPrototypeOf(e);if(typeof e!="function"||e===x||t!==x)return t;var r=e.prototype,n=r&&Object.getPrototypeOf(r);if(n==null||n===Object.prototype)return t;var d=n.constructor;return typeof d!="function"||d===e?t:d}function De(){var e;!l(D)&&typeof c.Reflect<"u"&&!(D in c.Reflect)&&typeof c.Reflect.defineMetadata=="function"&&(e=qe(c.Reflect));var t,r,n,d=new N,M={registerProvider:b,getProvider:o,setProvider:s};return M;function b(f){if(!Object.isExtensible(M))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case e===f:break;case l(t):t=f;break;case t===f:break;case l(r):r=f;break;case r===f:break;default:n===void 0&&(n=new H),n.add(f);break}}function p(f,h){if(!l(t)){if(t.isProviderFor(f,h))return t;if(!l(r)){if(r.isProviderFor(f,h))return t;if(!l(n))for(var v=ne(n);;){var _=oe(v);if(!_)return;var E=ae(_);if(E.isProviderFor(f,h))return ie(v),E}}}if(!l(e)&&e.isProviderFor(f,h))return e}function o(f,h){var v=d.get(f),_;return l(v)||(_=v.get(h)),l(_)&&(_=p(f,h),l(_)||(l(v)&&(v=new O,d.set(f,v)),v.set(h,_))),_}function i(f){if(l(f))throw new TypeError;return t===f||r===f||!l(n)&&n.has(f)}function s(f,h,v){if(!i(v))throw new Error("Metadata provider not registered.");var _=o(f,h);if(_!==v){if(!l(_))return!1;var E=d.get(f);l(E)&&(E=new O,d.set(f,E)),E.set(h,v)}return!0}}function Ie(){var e;return!l(D)&&w(c.Reflect)&&Object.isExtensible(c.Reflect)&&(e=c.Reflect[D]),l(e)&&(e=De()),!l(D)&&w(c.Reflect)&&Object.isExtensible(c.Reflect)&&Object.defineProperty(c.Reflect,D,{enumerable:!1,configurable:!1,writable:!1,value:e}),e}function je(e){var t=new N,r={isProviderFor:function(i,s){var f=t.get(i);return l(f)?!1:f.has(s)},OrdinaryDefineOwnMetadata:b,OrdinaryHasOwnMetadata:d,OrdinaryGetOwnMetadata:M,OrdinaryOwnMetadataKeys:p,OrdinaryDeleteMetadata:o};return $.registerProvider(r),r;function n(i,s,f){var h=t.get(i),v=!1;if(l(h)){if(!f)return;h=new O,t.set(i,h),v=!0}var _=h.get(s);if(l(_)){if(!f)return;if(_=new O,h.set(s,_),!e.setProvider(i,s,r))throw h.delete(s),v&&t.delete(i),new Error("Wrong provider for target.")}return _}function d(i,s,f){var h=n(s,f,!1);return l(h)?!1:K(h.has(i))}function M(i,s,f){var h=n(s,f,!1);if(!l(h))return h.get(i)}function b(i,s,f,h){var v=n(f,h,!0);v.set(i,s)}function p(i,s){var f=[],h=n(i,s,!1);if(l(h))return f;for(var v=h.keys(),_=ne(v),E=0;;){var ue=oe(_);if(!ue)return f.length=E,f;var He=ae(ue);try{f[E]=He}catch(Ne){try{ie(_)}finally{throw Ne}}E++}}function o(i,s,f){var h=n(s,f,!1);if(l(h)||!h.delete(i))return!1;if(h.size===0){var v=t.get(s);l(v)||(v.delete(f),v.size===0&&t.delete(v))}return!0}}function qe(e){var t=e.defineMetadata,r=e.hasOwnMetadata,n=e.getOwnMetadata,d=e.getOwnMetadataKeys,M=e.deleteMetadata,b=new N,p={isProviderFor:function(o,i){var s=b.get(o);return!l(s)&&s.has(i)?!0:d(o,i).length?(l(s)&&(s=new H,b.set(o,s)),s.add(i),!0):!1},OrdinaryDefineOwnMetadata:t,OrdinaryHasOwnMetadata:r,OrdinaryGetOwnMetadata:n,OrdinaryOwnMetadataKeys:d,OrdinaryDeleteMetadata:M};return p}function F(e,t,r){var n=$.getProvider(e,t);if(!l(n))return n;if(r){if($.setProvider(e,t,W))return W;throw new Error("Illegal state.")}}function Fe(){var e={},t=[],r=function(){function p(o,i,s){this._index=0,this._keys=o,this._values=i,this._selector=s}return p.prototype["@@iterator"]=function(){return this},p.prototype[g]=function(){return this},p.prototype.next=function(){var o=this._index;if(o>=0&&o<this._keys.length){var i=this._selector(this._keys[o],this._values[o]);return o+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:i,done:!1}}return{value:void 0,done:!0}},p.prototype.throw=function(o){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),o},p.prototype.return=function(o){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:o,done:!0}},p}(),n=function(){function p(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(p.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),p.prototype.has=function(o){return this._find(o,!1)>=0},p.prototype.get=function(o){var i=this._find(o,!1);return i>=0?this._values[i]:void 0},p.prototype.set=function(o,i){var s=this._find(o,!0);return this._values[s]=i,this},p.prototype.delete=function(o){var i=this._find(o,!1);if(i>=0){for(var s=this._keys.length,f=i+1;f<s;f++)this._keys[f-1]=this._keys[f],this._values[f-1]=this._values[f];return this._keys.length--,this._values.length--,L(o,this._cacheKey)&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},p.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},p.prototype.keys=function(){return new r(this._keys,this._values,d)},p.prototype.values=function(){return new r(this._keys,this._values,M)},p.prototype.entries=function(){return new r(this._keys,this._values,b)},p.prototype["@@iterator"]=function(){return this.entries()},p.prototype[g]=function(){return this.entries()},p.prototype._find=function(o,i){if(!L(this._cacheKey,o)){this._cacheIndex=-1;for(var s=0;s<this._keys.length;s++)if(L(this._keys[s],o)){this._cacheIndex=s;break}}return this._cacheIndex<0&&i&&(this._cacheIndex=this._keys.length,this._keys.push(o),this._values.push(void 0)),this._cacheIndex},p}();return n;function d(p,o){return p}function M(p,o){return o}function b(p,o){return[p,o]}}function Ge(){var e=function(){function t(){this._map=new O}return Object.defineProperty(t.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),t.prototype.has=function(r){return this._map.has(r)},t.prototype.add=function(r){return this._map.set(r,r),this},t.prototype.delete=function(r){return this._map.delete(r)},t.prototype.clear=function(){this._map.clear()},t.prototype.keys=function(){return this._map.keys()},t.prototype.values=function(){return this._map.keys()},t.prototype.entries=function(){return this._map.entries()},t.prototype["@@iterator"]=function(){return this.keys()},t.prototype[g]=function(){return this.keys()},t}();return e}function $e(){var e=16,t=k.create(),r=n();return function(){function o(){this._key=n()}return o.prototype.has=function(i){var s=d(i,!1);return s!==void 0?k.has(s,this._key):!1},o.prototype.get=function(i){var s=d(i,!1);return s!==void 0?k.get(s,this._key):void 0},o.prototype.set=function(i,s){var f=d(i,!0);return f[this._key]=s,this},o.prototype.delete=function(i){var s=d(i,!1);return s!==void 0?delete s[this._key]:!1},o.prototype.clear=function(){this._key=n()},o}();function n(){var o;do o="@@WeakMap@@"+p();while(k.has(t,o));return t[o]=!0,o}function d(o,i){if(!y.call(o,r)){if(!i)return;Object.defineProperty(o,r,{value:k.create()})}return o[r]}function M(o,i){for(var s=0;s<i;++s)o[s]=Math.random()*255|0;return o}function b(o){if(typeof Uint8Array=="function"){var i=new Uint8Array(o);return typeof crypto<"u"?crypto.getRandomValues(i):typeof msCrypto<"u"?msCrypto.getRandomValues(i):M(i,o),i}return M(new Array(o),o)}function p(){var o=b(e);o[6]=o[6]&79|64,o[8]=o[8]&191|128;for(var i="",s=0;s<e;++s){var f=o[s];(s===4||s===6||s===8)&&(i+="-"),f<16&&(i+="0"),i+=f.toString(16).toLowerCase()}return i}}function U(e){return e.__=void 0,delete e.__,e}})})(fe||(fe={}))});var It=Ye(ce(),1);var q=Symbol.for("DEPS_CTX");var de="controller:path",Qe="controller:config";function ze(u,a){return c=>{let y={deps:a};Reflect.defineMetadata(q,y,c);let m=Reflect.getMetadataKeys(c.prototype),T={rootPath:u,routerCtxs:new Map};for(let g of m)if(g.startsWith(de)){let P=g.split(":").slice(-1)[0];T.routerCtxs.set(P,Reflect.getMetadata(g,c.prototype))}Reflect.defineMetadata(Qe,T,c.prototype)}}function G(u,a,c){return(y,m,T)=>{let g=T.value,P=[];for(let R of Reflect.getMetadataKeys(y)){let[k,x,O]=R.split(":");switch(k){case"req":P[O]={type:"req",methodName:x};break;case"rep":P[O]={type:"rep",methodName:x};break;case"query":P[O]={type:"query",name:Reflect.getMetadata(R,y),methodName:x};break;case"param":P[O]={type:"param",name:Reflect.getMetadata(R,y),methodName:x};break;case"body":P[O]={type:"body",methodName:x};break;case"headers":P[O]={type:"headers",methodName:x};break;case"raw":P[O]={type:"raw",methodName:x};break}}let C={path:u,method:a,propertyKey:m,call(...R){return g?.apply(this,R)},opts:c,params:P};Reflect.defineMetadata(`${de}:${m}`,C,y)}}function Je(u,a){return G(u,"GET",a)}function Ze(u,a){return G(u,"POST",a)}function Ke(u,a){return G(u,"PUT",a)}function et(u,a){return G(u,"DELETE",a)}function tt(u,a){return G(u,"PATCH",a)}function rt(){return(u,a,c)=>{Reflect.defineMetadata(`body:${String(a)}:${c}`,null,u)}}function nt(u){return(a,c,y)=>{Reflect.defineMetadata(`query:${String(c)}:${y}`,u,a)}}function at(u){return(a,c,y)=>{Reflect.defineMetadata(`param:${String(c)}:${y}`,u,a)}}function ot(){return(u,a,c)=>{Reflect.defineMetadata(`req:${String(a)}:${c}`,null,u)}}function it(){return(u,a,c)=>{Reflect.defineMetadata(`rep:${String(a)}:${c}`,"rep",u)}}function ut(){return(u,a,c)=>{Reflect.defineMetadata(`raw:${String(a)}:${c}`,"raw",u)}}function st(){return(u,a,c)=>{Reflect.defineMetadata(`headers:${String(a)}:${c}`,"headers",u)}}var ft=Symbol.for("INJECTABLE_SERVICE");function xt(u){return a=>{let c={deps:u};Reflect.defineMetadata(q,c,a),Reflect.defineMetadata(ft,null,a)}}function le(u,a,c){return{request:u,reply:a,routerCtx:c}}function pe(u){let a=[];for(let y of u.params)switch(y.type){case"req":a.push("ctx.request");break;case"rep":a.push("ctx.reply");break;case"query":a.push(`ctx.request.query.${y.name}`);break;case"param":a.push(`ctx.request.params.${y.name}`);break;case"body":a.push("ctx.request.body");break;case"headers":a.push("ctx.request.headers");break;case"raw":a.push("ctx.request.raw");break}let c=`
  return function(fn, ctx) {
    return fn(${a.join(",")});
  }
  `;return new Function(c)()}function ct(u){let a=new Map,c=[];for(let y of u){let m=he(y,a);c.push(m)}return c}function he(u,a){if(a.has(u))return a.get(u);let{deps:c}=Reflect.getMetadata(q,u)||[],y=c.map(T=>he(T,a)),m=new u(...y);return a.set(u,m),m}function St(u,{controllers:a}){let c=ct(a);for(let y of c){let{routerCtxs:m,rootPath:T}=Reflect.getMetadata("controller:config",y);for(let[,g]of m.entries()){let P=pe(g),C=[T+g.path,g.opts??{},async(R,k)=>{let x=le(R,k,g);return P(y[g.propertyKey].bind(y),x)}];switch(g.method){case"GET":u.get(...C);break;case"DELETE":u.delete(...C);break;case"PATCH":u.patch(...C);break;case"POST":u.post(...C);break;case"PUT":u.put(...C);break}}}}export{rt as Body,ze as Controller,et as Delete,Je as Get,st as Headers,ft as INJECTABLE_SERVICE_SYMBOL,at as Parameter,tt as Patch,Ze as Post,Ke as Put,nt as Query,ut as Raw,it as Rep,ot as Req,xt as Service,St as registerControllers};
/*! Bundled license information:

reflect-metadata/Reflect.js:
  (*! *****************************************************************************
  Copyright (C) Microsoft. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0
  
  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.
  
  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** *)
*/
//# sourceMappingURL=index.js.map